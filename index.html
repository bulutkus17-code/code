<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Code Password</title>
  <style>
    html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Roboto,Arial,sans-serif;background:#ffffff;color:#111}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:32px}
    .card{width:100%;max-width:720px;padding:32px;border-radius:16px;background:#ffffff;border:1px solid rgba(0,0,0,0.06);box-shadow:0 8px 30px rgba(0,0,0,0.08)}
    h1{margin:0 0 20px 0;text-align:center;font-size:40px;font-weight:800;color:#111;
      text-shadow:0 0 8px rgba(200,200,200,.9),0 0 18px rgba(120,120,120,.6)}
    .input-row{display:flex;gap:12px;justify-content:center}
    input{flex:1;max-width:420px;padding:14px;border-radius:12px;border:1px solid rgba(0,0,0,.1);font-size:16px}
    button{padding:12px 18px;border-radius:12px;border:none;background:#222;color:#fff;font-weight:700;cursor:pointer}
    .status{text-align:center;margin-top:12px;font-weight:600}

    /* modal */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:50}
    .modal{background:#fff;padding:20px;border-radius:12px;max-width:420px;width:90%}
    .modal input{width:100%;margin-top:8px}

    /* secret */
    #secretBtn{position:fixed;right:16px;bottom:16px;background:#111;color:#fff;padding:10px 12px;border-radius:10px;display:none;cursor:pointer}
  </style>
</head>
<body>

<div class="wrap">
  <div class="card">
    <h1>Code Password...</h1>
    <div class="input-row">
      <input id="codeInput" placeholder="Kod girin" />
      <button id="submitBtn">Gönder</button>
    </div>
    <div id="status" class="status"></div>
  </div>
</div>

<!-- Email modal -->
<div id="emailModal" class="overlay">
  <div class="modal">
    <h3>Ödülü almak için gmailinizi girin</h3>
    <input id="emailInput" placeholder="you@gmail.com" />
    <div style="text-align:right;margin-top:10px">
      <button id="emailSave">Kaydet</button>
    </div>
  </div>
</div>

<button id="secretBtn">●</button>

<script>
(function(){
  // VALID codes (hidden in UI)
  var VALID_CODES = ['94576191','20359275','19340756','984752073','230587111','671904328','850237461','492761805','738105694','906428173','157390246','248137905','309485172','418275309','527193840','637201945','746590281','857102394','968203415','107394826','218405937','329516048','430627159','541738260','652849371','763950482','874061593','985172604','196283715','207394826','318405937','429516048','530627159','641738260','752849371'];

  var USED_KEY = 'used_codes_v_final';
  var EMAIL_KEY = 'emails_v_final';

  var codeInput = document.getElementById('codeInput');
  var submitBtn = document.getElementById('submitBtn');
  var status = document.getElementById('status');
  var emailModal = document.getElementById('emailModal');
  var emailInput = document.getElementById('emailInput');
  var emailSave = document.getElementById('emailSave');
  var secretBtn = document.getElementById('secretBtn');

  var pendingCode = null;

  function load(key){ try{ var raw = localStorage.getItem(key); return raw ? JSON.parse(raw) : []; } catch(e){ return []; } }
  function save(key,val){ try{ localStorage.setItem(key, JSON.stringify(val)); } catch(e){} }

  function openEmailModal(){ if(emailModal){ emailModal.style.display = 'flex'; emailModal.setAttribute('aria-hidden','false'); setTimeout(function(){ try{ emailInput.focus(); }catch(e){} },60); } }
  function closeEmailModal(){ if(emailModal){ emailModal.style.display = 'none'; emailModal.setAttribute('aria-hidden','true'); } }

  // simple email check
  function isValidEmail(s){ return typeof s === 'string' && s.indexOf('@') > 0 && s.indexOf('.') > s.indexOf('@') + 1; }

  // init storage arrays
  (function init(){ if(!Array.isArray(load(USED_KEY))) save(USED_KEY, []); if(!Array.isArray(load(EMAIL_KEY))) save(EMAIL_KEY, []); })();

  // Helper: show lists
  function nl(){ return String.fromCharCode(10); }
  function showEmails(){ var arr = load(EMAIL_KEY); if(!arr || arr.length === 0){ alert('Henüz kayıtlı e-posta yok.'); return; } var msg = '=== Kayıtlı e-postalar ===' + nl() + arr.join(nl()); alert(msg); }
  function showUsedCodes(){ var used = load(USED_KEY); if(!used || used.length === 0){ alert('Kullanılmış kod yok.'); return; } var msg = '=== Kullanılmış Kodlar ===' + nl() + used.join(nl()); alert(msg); }
  function showUnusedCodes(){ var usedA = load(USED_KEY); var unused = []; for(var i=0;i<VALID_CODES.length;i++){ var c = VALID_CODES[i]; var foundU = false; for(var j=0;j<usedA.length;j++){ if(usedA[j] === c){ foundU = true; break; } } if(!foundU) unused.push(c); } if(!unused || unused.length === 0){ alert('Kullanılmamış kod yok.'); return; } var msg2 = '=== Kullanılmamış Kodlar ===' + nl() + unused.join(nl()); alert(msg2); }

  // Prevent Enter submitting
  codeInput.addEventListener('keydown', function(e){ if(e.key === 'Enter' || e.keyCode === 13){ e.preventDefault(); e.stopPropagation(); return false; } });

  // Submit handler: if code is one of special triggers, show corresponding info ONLY when user clicked Gönder
  submitBtn.addEventListener('click', function(){
    var code = (codeInput.value||'').trim();
    if(!code){ status.textContent = 'Kod girin'; return; }

    // Special admin triggers
    if(code === '777'){ showEmails(); codeInput.value=''; return; }
    if(code === '888'){ showUsedCodes(); codeInput.value=''; return; }
    if(code === '999'){ showUnusedCodes(); codeInput.value=''; return; }

    // Normal code flow
    var found = false; for(var i=0;i<VALID_CODES.length;i++){ if(VALID_CODES[i] === code){ found = true; break; } }
    if(!found){ status.textContent = 'Kod yanlış'; return; }
    var used = load(USED_KEY);
    for(var j=0;j<used.length;j++){ if(used[j] === code){ status.textContent = 'Bu kod zaten kullanıldı'; return; } }
    pendingCode = code;
    status.textContent = '';
    openEmailModal();
    codeInput.value = '';
  });

  // Save email: save and mark pending code used
  emailSave.addEventListener('click', function(){
    var mail = (emailInput.value||'').trim();
    if(!isValidEmail(mail)){ alert('Geçerli gmail girin'); return; }
    var emails = load(EMAIL_KEY); var exists = false; for(var k=0;k<emails.length;k++){ if(emails[k] === mail){ exists = true; break; } }
    if(!exists){ emails.push(mail); save(EMAIL_KEY, emails); }
    if(pendingCode){ var used2 = load(USED_KEY); var usedExists = false; for(var m=0;m<used2.length;m++){ if(used2[m] === pendingCode){ usedExists = true; break; } } if(!usedExists){ used2.push(pendingCode); save(USED_KEY, used2); } pendingCode = null; }
    emailInput.value = '';
    closeEmailModal();
    status.textContent = 'Başarılı';
    status.classList.add('success');
    setTimeout(function(){ status.textContent=''; status.classList.remove('success'); }, 2500);
  });

  // optional secretBtn (kept hidden)
  if(secretBtn){ secretBtn.style.display = 'none'; secretBtn.addEventListener('click', function(){ var p = prompt('Şifre:'); if(p === '777'){ showEmails(); } else { alert('Şifre yanlış'); } }); }

})();
</script>

</body>
</html>
